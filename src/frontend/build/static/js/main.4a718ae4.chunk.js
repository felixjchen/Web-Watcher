(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{44:function(e,t,a){e.exports=a.p+"static/media/threetree_90.8428407b.png"},53:function(e,t,a){e.exports=a(65)},60:function(e,t,a){},63:function(e,t,a){},65:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),c=a(18),l=a(0),o=a.n(l),s=a(82),i=a(15),u=a(71),d=a(86),m=a(72),p=a(73),f=a(74),h=a(84),E=a(87),g=(a(60),a(44)),x=a.n(g),b=function(e){return o.a.createElement("div",{id:"login"},o.a.createElement(u.a,{"aria-label":"header"},o.a.createElement(d.a,{href:"#",prefix:"Web"},"Watcher")),o.a.createElement(m.a,null,o.a.createElement(p.a,null,o.a.createElement(f.a,{id:"leftBox",sm:{span:4,offset:0},md:{span:4,offset:1},lg:{span:4,offset:2}},o.a.createElement("h1",{className:"bx--type-semibold"},"Sign in to your account"),o.a.createElement(h.a,{id:"email",labelText:"Email"}),o.a.createElement(h.a.PasswordInput,{id:"password",labelText:"Password"}),o.a.createElement(E.a,{size:"small",kind:"secondary",onClick:e.signupHandler},"Sign up"),o.a.createElement(E.a,{size:"small",onClick:e.loginHandler},"Log in")),o.a.createElement(f.a,{id:"rightBox",sm:{span:0},md:{span:2},lg:{span:4}},o.a.createElement("img",{src:x.a,alt:"fractel"})))))},y=a(45),w=a(46),v=a(50),O=a(47),k=a(51),T=a(75),j=a(76),S=a(77),B=a(83),I=a(33),C=a(36),P=a(37),M=a(39),H=a(31),W=a(34),J=a(35),N=a(38),L=a(32),F=a(85),R=a(80),q=a(16),z=a(88),D=a(78),_=(a(63),[{key:"url",header:"URL"},{key:"frequency",header:"Frequency"},{key:"last_run",header:"Last Run"},{key:"options",header:""}]),U=function(e){function t(e){var a;return Object(y.a)(this,t),(a=Object(v.a)(this,Object(O.a)(t).call(this,e))).openModal=function(){a.setState({addWatcherModalOpen:!0})},a.closeModal=function(){a.setState({addWatcherModalOpen:!1})},a.state={addWatcherModalOpen:!1},a}return Object(k.a)(t,e),Object(w.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{id:"page"},o.a.createElement(T.a,{render:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(u.a,{"aria-label":"IBM Platform Name"},o.a.createElement(d.a,{prefix:"Web"},"Watcher"),o.a.createElement(j.a,null,o.a.createElement(S.a,{id:"logoutIcon","aria-label":"Logout",onClick:e.props.logoutHandler},o.a.createElement(D.a,null)))))}}),o.a.createElement(B.a,{rows:this.props.watchers,headers:_},function(t){var a=t.rows,n=t.headers,r=t.getHeaderProps,c=t.getRowProps,l=t.getTableProps,s=t.getToolbarProps,i=t.onInputChange,u=t.getTableContainerProps;return o.a.createElement(I.a,u(),o.a.createElement(C.a,Object.assign({},s(),{"aria-label":"data table toolbar"}),o.a.createElement(P.a,null,o.a.createElement(M.a,{onChange:i}),o.a.createElement(E.a,{onClick:e.openModal},"Add Watcher"))),o.a.createElement(H.a,l(),o.a.createElement(W.a,null,o.a.createElement(J.a,null,n.map(function(e){return o.a.createElement(N.a,Object.assign({key:e.key},r({header:e})),e.header)}))),o.a.createElement(L.a,null,a.map(function(e){return e.cells[3].value=o.a.createElement(F.a,{flipped:!0},o.a.createElement(R.a,{itemText:"Edit"}),o.a.createElement(R.a,{itemText:"Delete",hasDivider:!0,isDelete:!0})),o.a.createElement(J.a,Object.assign({key:e.id},c({row:e})),e.cells.map(function(e){return o.a.createElement(q.a,{key:e.id},e.value)}))}))))}),o.a.createElement(z.a,{hasForm:!0,size:"sm",selectorPrimaryFocus:"#text-input-2",open:this.state.addWatcherModalOpen,primaryButtonText:"Add",secondaryButtonText:"Cancel",shouldSubmitOnEnter:!0,onRequestClose:this.closeModal,onSecondarySubmit:this.closeModal},o.a.createElement(h.a,{id:"text-input-1",labelText:"URL",placeholder:"https://www.google.com/",style:{marginBottom:"1rem"}}),o.a.createElement(h.a,{id:"text-input-2",labelText:"Frequency (seconds)",placeholder:"60"})))}}]),t}(o.a.Component),A="https://bwaexdxnvc.execute-api.us-east-2.amazonaws.com/prod",G=null,K=function(){var e=Object(c.a)(r.a.mark(function e(t){var a,n,c,l,u,d,m,p;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,n=t.password,null==a&&(a=document.getElementById("email").value),null==n&&(n=document.getElementById("password").value),Object(i.render)(o.a.createElement(s.a,null),document.getElementById("root")),c={method:"POST",credentials:"include",body:JSON.stringify({email:a,password:n}),headers:{"Content-Type":"application/json"},redirect:"follow"},e.next=7,fetch("".concat(A,"/login"),c);case 7:return l=e.sent,e.next=10,l.text();case 10:if(u=e.sent,d=JSON.parse(u),m=d.success,p=d.accessTokenExpiry,console.log(u),m){e.next=18;break}alert("Login failed: username/password error"),Object(i.render)(o.a.createElement(b,{signupHandler:V,loginHandler:K}),document.getElementById("root")),e.next=21;break;case 18:return e.next=20,X();case 20:G=setTimeout(Y,1e3*(p-2));case 21:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(c.a)(r.a.mark(function e(){var t,a,n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},redirect:"follow"},e.next=3,fetch("".concat(A,"/logout"),t);case 3:return a=e.sent,e.next=6,a.text();case 6:return n=e.sent,Object(i.render)(o.a.createElement(b,{signupHandler:V,loginHandler:K}),document.getElementById("root")),clearTimeout(G),e.abrupt("return",JSON.parse(n).success);case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(c.a)(r.a.mark(function e(){var t,a,n,c,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("email").value,a=document.getElementById("password").value,Object(i.render)(o.a.createElement(s.a,null),document.getElementById("root")),n={method:"POST",credentials:"include",body:JSON.stringify({email:t,password:a}),headers:{"Content-Type":"application/json"},redirect:"follow"},e.next=6,fetch("".concat(A,"/user"),n);case 6:return c=e.sent,e.next=9,c.text();case 9:l=e.sent,console.log(l),K({email:t,password:a});case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(c.a)(r.a.mark(function e(){var t,a,n,c,l,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={credentials:"include"},e.next=3,fetch("".concat(A,"/user"),t);case 3:return a=e.sent,e.next=6,a.text();case 6:n=e.sent,c=JSON.parse(n),l=c.email,(s=c.watchers).forEach(function(e){var t=new Date(0);t.setUTCSeconds(e.last_run),e.last_run=String(t)}),Object(i.render)(o.a.createElement(U,{logoutHandler:Q,email:l,watchers:s}),document.getElementById("root"));case 10:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(c.a)(r.a.mark(function e(){var t,a,n,c,l,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",credentials:"include"},e.next=3,fetch("".concat(A,"/refresh"),t);case 3:return a=e.sent,e.next=6,a.text();case 6:if(n=e.sent,c=JSON.parse(n),l=c.success,o=c.accessTokenExpiry,l){e.next=13;break}return e.next=11,Q();case 11:e.next=16;break;case 13:return G=setTimeout(Y,1e3*(o-2)),e.next=16,X();case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y();case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Initial silent refresh fail "+e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}();Object(i.render)(o.a.createElement(s.a,null),document.getElementById("root")),Z()}},[[53,1,2]]]);
//# sourceMappingURL=main.4a718ae4.chunk.js.map