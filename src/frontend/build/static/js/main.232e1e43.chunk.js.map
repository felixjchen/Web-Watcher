{"version":3,"sources":["components/threetree_90.png","components/login.js","components/page.js","index.js"],"names":["module","exports","__webpack_require__","p","Login","props","react_default","a","createElement","id","Header","aria-label","HeaderName","href","prefix","Grid","Row","Column","sm","span","offset","md","lg","className","TextInput","labelText","PasswordInput","Button","size","onClick","handler","src","fractel","alt","Page","HeaderContainer","render","_ref","isSideNavExpanded","onClickSideNavExpand","Fragment","HeaderMenuButton","isCollapsible","isActive","HeaderNavigation","HeaderMenuItem","HeaderMenu","menuLinkName","HeaderGlobalBar","HeaderGlobalAction","logoutHandler","bucket_10","SideNav","isRail","expanded","SideNavItems","SideNavLink","aria-current","renderIcon","Fade16","SideNavMenu","title","SideNavMenuItem","gatewayAddress","silentRefreshTimeout","login","Object","asyncToGenerator","regenerator_default","mark","_callee","payload","options","response","responseText","_JSON$parse","success","accessTokenExpiry","wrap","_context","prev","next","document","getElementById","value","email","password","method","credentials","body","JSON","stringify","headers","Content-Type","redirect","fetch","concat","sent","text","parse","console","log","alert","getProfile","setTimeout","silentRefresh","stop","apply","this","arguments","logout","_ref2","_callee2","requestOptions","_context2","components_login","clearTimeout","abrupt","_ref3","_callee3","_context3","components_page","_ref4","_callee4","_JSON$parse2","_context4","initialSilentRefresh","_ref5","_callee5","_context5","t0","Loading"],"mappings":"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","file":"static/js/main.232e1e43.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/threetree_90.8428407b.png\";","import React from \"react\";\nimport {\n  Header,\n  HeaderName,\n  Grid,\n  Row,\n  Column,\n  Button,\n  TextInput,\n} from \"carbon-components-react\";\nimport \"./login.css\";\nimport fractel from \"./threetree_90.png\";\n\nconst Login = (props) => (\n  <div id=\"login\">\n    <Header aria-label=\"header\">\n      <HeaderName href=\"#\" prefix=\"Web\">\n        Watcher\n      </HeaderName>\n    </Header>\n    <Grid>\n      <Row>\n        <Column\n          id=\"leftBox\"\n          sm={{ span: 4, offset: 0 }}\n          md={{ span: 4, offset: 1 }}\n          lg={{ span: 4, offset: 2 }}\n        >\n          <h1 className=\"bx--type-semibold\">Sign in to your account</h1>\n          <TextInput id=\"email\" labelText=\"Email\" />\n          <TextInput.PasswordInput id=\"password\" labelText=\"Password\" />\n          <Button size=\"small\" onClick={props.handler}>\n            Log in\n          </Button>\n        </Column>\n        <Column\n          id=\"rightBox\"\n          sm={{ span: 0 }}\n          md={{ span: 2 }}\n          lg={{ span: 4 }}\n        >\n          <img src={fractel} alt=\"fractel\"></img>\n        </Column>\n      </Row>\n    </Grid>\n  </div>\n);\n\nexport default Login;\n","import React from \"react\";\nimport {\n  Header,\n  HeaderName,\n  HeaderNavigation,\n  HeaderMenu,\n  HeaderMenuItem,\n  HeaderMenuButton,\n  HeaderContainer,\n  HeaderGlobalBar,\n  HeaderGlobalAction,\n  SideNav,\n  SideNavMenuItem,\n  SideNavItems,\n  SideNavLink,\n  SideNavMenu,\n  PropTypes,\n} from \"carbon-components-react\";\nimport { Fade16, Logout20 } from \"@carbon/icons-react\";\nimport \"./page.css\";\n\nconst Page = (props) => (\n  <div id=\"page\">\n    <HeaderContainer\n      render={({ isSideNavExpanded, onClickSideNavExpand }) => (\n        <>\n          <Header aria-label=\"IBM Platform Name\">\n            <HeaderMenuButton\n              aria-label=\"Open menu\"\n              isCollapsible\n              onClick={onClickSideNavExpand}\n              isActive={isSideNavExpanded}\n            />\n            <HeaderName prefix=\"Web\">Watcher</HeaderName>\n            <HeaderNavigation aria-label=\"FC Watcher\">\n              <HeaderMenuItem>Link 1</HeaderMenuItem>\n              <HeaderMenuItem>Link 2</HeaderMenuItem>\n\n              <HeaderMenu aria-label=\"Link 3\" menuLinkName=\"Link 3\">\n                <HeaderMenuItem>Sub-link 1</HeaderMenuItem>\n                <HeaderMenuItem>Sub-link 2</HeaderMenuItem>\n                <HeaderMenuItem>Sub-link 3</HeaderMenuItem>\n              </HeaderMenu>\n            </HeaderNavigation>\n\n            <HeaderGlobalBar>\n              <HeaderGlobalAction\n                aria-label=\"Logout\"\n                onClick={props.logoutHandler}\n              >\n                <Logout20 />\n              </HeaderGlobalAction>\n            </HeaderGlobalBar>\n\n            <SideNav\n              aria-label=\"Side navigation\"\n              isRail\n              expanded={isSideNavExpanded}\n            >\n              <SideNavItems>\n                <SideNavLink aria-current=\"page\" renderIcon={Fade16}>\n                  Link\n                </SideNavLink>\n                <SideNavLink renderIcon={Fade16}>Link</SideNavLink>\n                <SideNavMenu renderIcon={Fade16} title=\"Category title\">\n                  <SideNavMenuItem aria-current=\"page\">Link</SideNavMenuItem>\n                  <SideNavMenuItem>Link</SideNavMenuItem>\n                  <SideNavMenuItem>Link</SideNavMenuItem>\n                </SideNavMenu>\n              </SideNavItems>\n            </SideNav>\n          </Header>\n        </>\n      )}\n    />\n  </div>\n);\n\nexport default Page;\n","\"use strict\";\n\nimport React from \"react\";\nimport { Loading } from \"carbon-components-react\";\nimport { render } from \"react-dom\";\n\nimport Login from \"./components/login\";\nimport Page from \"./components/page\";\n\nconst gatewayAddress =\n  \"https://bwaexdxnvc.execute-api.us-east-2.amazonaws.com/prod\";\nlet silentRefreshTimeout = null;\n\nlet login = async () => {\n  let email = document.getElementById(\"email\").value;\n  let password = document.getElementById(\"password\").value;\n\n  email = \"felixchen1998@gmail.com\";\n  password = \"dude\";\n\n  let payload = { email, password };\n  let options = {\n    method: \"POST\",\n    credentials: \"include\",\n    body: JSON.stringify(payload),\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    redirect: \"follow\",\n  };\n\n  let response = await fetch(`${gatewayAddress}/login`, options);\n  let responseText = await response.text();\n  let { success, accessTokenExpiry } = JSON.parse(responseText);\n\n  console.log(responseText);\n  if (!success) {\n    alert(\"Bad Login\");\n  } else {\n    await getProfile();\n    // Start silent refresh a couple seconds early... so we always have an access token\n    silentRefreshTimeout = setTimeout(\n      silentRefresh,\n      (accessTokenExpiry - 1) * 1000\n    );\n  }\n};\n\nlet logout = async () => {\n  var requestOptions = {\n    method: \"POST\",\n    credentials: \"include\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    redirect: \"follow\",\n  };\n\n  let response = await fetch(`${gatewayAddress}/logout`, requestOptions);\n  let responseText = await response.text();\n  render(<Login handler={login} />, document.getElementById(\"root\"));\n\n  // Stop silent refresh\n  clearTimeout(silentRefreshTimeout);\n\n  return JSON.parse(responseText).success;\n};\n\nlet getProfile = async () => {\n  var requestOptions = {\n    credentials: \"include\",\n  };\n\n  let response = await fetch(`${gatewayAddress}/user`, requestOptions);\n  let responseText = await response.text();\n  console.log(JSON.parse(responseText));\n  render(<Page logoutHandler={logout} />, document.getElementById(\"root\"));\n};\n\nlet silentRefresh = async () => {\n  let requestOptions = {\n    method: \"POST\",\n    credentials: \"include\",\n  };\n\n  let response = await fetch(`${gatewayAddress}/refresh`, requestOptions);\n  let responseText = await response.text();\n  let { success, accessTokenExpiry } = JSON.parse(responseText);\n\n  // If something is wrong with refresh token.. we logout\n  if (!success) {\n    await logout();\n  } else {\n    // Start silent refresh a couple seconds early... so we always have an access token\n    silentRefreshTimeout = setTimeout(\n      silentRefresh,\n      (accessTokenExpiry - 1) * 1000\n    );\n  }\n\n  return success;\n};\n\nlet initialSilentRefresh = async () => {\n  try {\n    let success = await silentRefresh();\n\n    if (success) {\n      await getProfile();\n    }\n  } catch (err) {\n    console.log(\"Initial silent refresh fail \" + err);\n  }\n};\n\nrender(<Loading />, document.getElementById(\"root\"));\ninitialSilentRefresh();\n"],"sourceRoot":""}